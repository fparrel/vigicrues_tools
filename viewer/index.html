<!DOCTYPE html>
<meta charset="utf-8">
<html>
<head></head>
<body>
<div id="stations">
</div>
</body>
<script>
var request = new XMLHttpRequest();
request.open("GET", "stations.json", false);
request.send(null);
var stations=JSON.parse(request.responseText);
var i;
var html='<ul>';
var rivers={};
for(i=0;i<stations.length;i++) {
    contents = '<li><a href="view.html?station_id='+stations[i].id+'">'+stations[i].name+' (Hauteur)</a></li>'
             + '<li><a href="view.html?station_id='+stations[i].id+'-q">'+stations[i].name+' (DÃ©bit)</a></li>';
    if (typeof(rivers[stations[i].river])==='undefined') {
        rivers[stations[i].river] = contents;
    } else {
        rivers[stations[i].river] += contents;
    }
}
var rivers_sorted = Object.keys(rivers);
rivers_sorted.sort(function (a, b) {
    return a.toLowerCase().localeCompare(b.toLowerCase());
});
for(var i=0;i<rivers_sorted.length;i++) {
    html += '<li>' + rivers_sorted[i] + ': <ul>' + rivers[rivers_sorted[i]] + '</ul></li>';
}
html+='</ul>';
document.getElementById("stations").innerHTML = html;
</script>
</html>
